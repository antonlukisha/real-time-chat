{"ast":null,"code":"var _jsxFileName = \"C:\\\\RealTimeChat\\\\client\\\\src\\\\components\\\\MainWindow.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport LoginForm from './LoginForm';\nimport MessageInput from './MessageInput';\nimport MessageField from './MessageField';\nimport UserSearch from './UserSearch';\nimport NavigationHead from './NavigationHead';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:8000');\nfunction MainWindow() {\n  _s();\n  // main functional\n  const [username, setUsername] = useState(''); // current username\n  const [channelName, setChannelName] = useState(''); // current chat\n  const [message, setMessage] = useState(''); // message from input\n  const [messages, setMessages] = useState([]); // state of messages from chat\n  const [userList, setUserList] = useState([]); // users\n  const [searchedMember, setSearchedMember] = useState(''); //searched member of chat\n  const [loginForm, setLoginForm] = useState(true);\n  const endRef = useRef(null);\n  useEffect(() => {\n    if (endRef.current) {\n      endRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n  useEffect(() => {\n    // actions after rendering\n    socket.on('join-user', user => {\n      setUserList(prevUserList => [...prevUserList, `${user.username}`]);\n    });\n    socket.on('receive-message', data => {\n      const formattedMessage = {\n        username: data.username,\n        content: data.content,\n        timestamp: data.timestamp\n      };\n      setMessages(prevMessages => [...prevMessages, formattedMessage]);\n    });\n    socket.on('update-members', members => {\n      setUserList(members);\n    });\n    socket.on('update-message', messages => {\n      setMessages(messages);\n    });\n    if (channelName) {\n      socket.emit('get-messages', channelName);\n    }\n    return () => {\n      // cansel all subs \n      socket.off('join-user');\n      socket.off('update-members');\n      socket.off('receive-message');\n      socket.off('update-message');\n    };\n  }, [channelName]);\n  const joinChannel = () => {\n    if (username && channelName) {\n      socket.emit('join-channel', {\n        channel_name: channelName,\n        username: username\n      });\n      setLoginForm(false); // hide login form\n    }\n  };\n  const sendMessage = () => {\n    if (message.trim() && channelName && username) {\n      // clear spaces around the message\n      const data = {\n        content: message,\n        channel_name: channelName,\n        username\n      };\n      socket.emit('send-message', data); // send 'send-message' event to server\n      setMessage(''); // сlear input after sending\n    }\n  };\n  const searchUsers = () => {\n    if (searchedMember) {\n      socket.emit('search-users', searchedMember);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [loginForm && /*#__PURE__*/_jsxDEV(LoginForm, {\n      username: username,\n      setUsername: setUsername,\n      setChannelName: setChannelName,\n      channelName: channelName,\n      joinChannel: joinChannel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }, this), !loginForm && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(NavigationHead, {\n        searchedMember: searchedMember,\n        setSearchedMember: setSearchedMember,\n        userList: userList,\n        searchUsers: searchUsers\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          paddingBottom: '100px'\n        },\n        children: /*#__PURE__*/_jsxDEV(MessageField, {\n          messages: messages\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: endRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n        message: message,\n        setMessage: setMessage,\n        sendMessage: sendMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n}\n_s(MainWindow, \"qbxllUbCrZWYo/QHLZxB1bk/41c=\");\n_c = MainWindow;\nexport default MainWindow;\nvar _c;\n$RefreshReg$(_c, \"MainWindow\");","map":{"version":3,"names":["React","useState","useEffect","useRef","LoginForm","MessageInput","MessageField","UserSearch","NavigationHead","io","jsxDEV","_jsxDEV","Fragment","_Fragment","socket","MainWindow","_s","username","setUsername","channelName","setChannelName","message","setMessage","messages","setMessages","userList","setUserList","searchedMember","setSearchedMember","loginForm","setLoginForm","endRef","current","scrollIntoView","behavior","on","user","prevUserList","data","formattedMessage","content","timestamp","prevMessages","members","emit","off","joinChannel","channel_name","sendMessage","trim","searchUsers","children","fileName","_jsxFileName","lineNumber","columnNumber","style","paddingBottom","ref","_c","$RefreshReg$"],"sources":["C:/RealTimeChat/client/src/components/MainWindow.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport LoginForm from './LoginForm';\r\nimport MessageInput from './MessageInput';\r\nimport MessageField from './MessageField';\r\nimport UserSearch from './UserSearch';\r\nimport NavigationHead from './NavigationHead';\r\nimport io from 'socket.io-client';\r\n\r\n\r\nconst socket = io('http://localhost:8000');\r\n\r\nfunction MainWindow() {\r\n\r\n  // main functional\r\n  const [username, setUsername] = useState(''); // current username\r\n  const [channelName, setChannelName] = useState(''); // current chat\r\n  const [message, setMessage] = useState(''); // message from input\r\n  const [messages, setMessages] = useState([]); // state of messages from chat\r\n  const [userList, setUserList] = useState([]); // users\r\n  const [searchedMember, setSearchedMember] = useState(''); //searched member of chat\r\n  const [loginForm, setLoginForm] = useState(true);\r\n\r\n  const endRef = useRef(null);\r\n  useEffect(() => {\r\n    if (endRef.current) {\r\n      endRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  }, [messages]);\r\n\r\n  useEffect(() => { // actions after rendering\r\n    socket.on('join-user', (user) => {\r\n      setUserList((prevUserList) => [...prevUserList, `${user.username}`]);\r\n    });\r\n\r\n    socket.on('receive-message', (data) => {\r\n      const formattedMessage = {\r\n        username: data.username,\r\n        content: data.content,\r\n        timestamp: data.timestamp,\r\n      };\r\n      setMessages((prevMessages) => [...prevMessages, formattedMessage]);\r\n    });\r\n\r\n    socket.on('update-members', (members) => {\r\n      setUserList(members);\r\n    });\r\n\r\n    socket.on('update-message', (messages) => {\r\n      setMessages(messages);\r\n    });\r\n\r\n    if (channelName) {\r\n      socket.emit('get-messages', channelName);\r\n    }\r\n\r\n    return () => { // cansel all subs \r\n      socket.off('join-user');\r\n      socket.off('update-members');\r\n      socket.off('receive-message');\r\n      socket.off('update-message');\r\n    };\r\n  }, [channelName]);\r\n\r\n  const joinChannel = () => {\r\n    if (username && channelName) {\r\n      socket.emit('join-channel', { channel_name: channelName, username: username });\r\n      setLoginForm(false); // hide login form\r\n    }\r\n  };\r\n\r\n  const sendMessage = () => {\r\n    if (message.trim() && channelName && username) {  // clear spaces around the message\r\n      const data = {\r\n        content: message,\r\n        channel_name: channelName,\r\n        username,\r\n      };\r\n      socket.emit('send-message', data); // send 'send-message' event to server\r\n      setMessage(''); // сlear input after sending\r\n    }\r\n  };\r\n\r\n  const searchUsers = () => {\r\n    if (searchedMember) {\r\n      socket.emit('search-users', searchedMember);\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <>\r\n      {loginForm && (\r\n        <LoginForm\r\n          username={username}\r\n          setUsername={setUsername}\r\n          setChannelName={setChannelName}\r\n          channelName={channelName}\r\n          joinChannel={joinChannel}\r\n        />\r\n      )}\r\n      {!loginForm && (\r\n        <>\r\n          <NavigationHead\r\n            searchedMember={searchedMember}\r\n            setSearchedMember={setSearchedMember}\r\n            userList={userList}\r\n            searchUsers={searchUsers}\r\n          />\r\n          <div style={{ paddingBottom: '100px' }}>\r\n            <MessageField messages={messages} />\r\n          </div>\r\n          <div ref={endRef} />\r\n          <MessageInput message={message} setMessage={setMessage} sendMessage={sendMessage}/>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MainWindow;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}